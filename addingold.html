<!DOCTYPE html>
<html>
<head>
  <title>Dumb adding thing.</title>
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #EEE;
    }
    a:visited {
      color: blue;
    }
    #numberBox {
      border: 2px solid black;
      border-radius: 5px;
      background: maroon;
      color: white;
      padding: 5px;
      font-width: bold;
      display: inline-block;
      clear: both;
    }
  </style>
<meta name="viewport" content="width=device-width, user-scalable=no">
<meta charset="utf-8" >
</head>
<body>
  <div id="numberBox"><p>You have <span id="totalNumber">0</span> of them.</p>
  <p>You get one every 5 seconds.</p></div>
  <div id="debug" style="display: none;"><input type="button" onClick="subtractOne()" value="-1"><input type="button" onClick="addOne()" value="+1"><br><input type="button" onClick="eventOccurance()" value="Force an event"></div>
  <p id="event"></p>
  <input type="button" id="eventbutton" onClick="endEvent()" value="OK" style="display: none;">
  <p><details>
    <summary>Latest Changes</summary>
    <ul>
      <li>Strings loaded from localstorage are thrown through parseInt() so they stay as a number.</li>
      <li>Added latest changes.</li>
      <li>Loading uses modulos so we can check if it's NaN or not an integer and set it to 0.</li>
      <li>Game saves on each number change, rather than every 10 minutes.</li>
      <li>Events occur randomly between 1 and 10 minutes from the last.</li>
    </ul>
  </details>
  <details>
    <summary>To do</summary>
    <ul>
      <li>Events should save that they're active so a user can't get out of them by refreshing.</li>
    </ul>
  </details></p>

  <p><input type="button" onClick="resetAll()" value="DELETE STORED VALUES"></p>

<input type="button" onClick="toggleDebug()" value="Toggle Debug Functions">
  <script>
debug = false;

numberBox = document.getElementById('totalNumber');
var numberTotal = parseInt(localStorage['total']);
if (numberTotal % 1 != 0) {
  numberTotal = 0;
}
numberBox.innerHTML = numberTotal; //Render the number loaded.
eventActive=false;
setInterval(addOne, 5000);
setInterval(eventOccurance, 60000);
setInterval(gameSave, 600000); // Save every 10 minutes just in case.

function addOne() {
  if (eventActive == false) {
    numberTotal += 1;
    numberBox.innerHTML = numberTotal;
    gameSave();
  }
}
function subtractOne() {
  if (eventActive == false) {
    if (numberTotal == 0) {return false;}
    numberTotal -= 1;
    numberBox.innerHTML = numberTotal;
    gameSave();
  }
}

function gameSave() {
  localStorage['total'] = numberTotal;
}

function supports_local_storage() {
  try {
    return 'localStorage' in window && window['localStorage'] !== null;
  } catch(e){
    return false;
  }
}

if (supports_local_storage == false) {
  document.write("<p>I'M LIVIN' IN THE TWENNY-FIRST CENTURY<br>DOIN' SOM'IN MEAN TO IT<br>DOIN BEDDA DEN ANYBODY Y'EVA SEEN DO IT<br>SCREAMS FROM DA HATERS, GOT A NICE RING TO IT.<br>I GUESS ERRY SUPERHERO NEED HIS THEME MUSIC</p><p>Your browser is old as dirt. Go get yourself an upgrade.</p>");
}

function resetAll() {
  if (confirm('Reset all values to 0?') == true) {
    localStorage.removeItem('total');
    document.write('Variables deleted. You may close the page or reload to start over.');
  }
}

//events

function randomIntfromInterval(min, max) {
    return Math.floor(Math.random()*(max-min+1)+min);
}

var events = new Array();
events[0]="testEvent";
events[1]="testEventTwo";

var eventBox = document.getElementById('event');

function eventOccurance() {
  if (eventActive != true) {
    thisEvent = randomIntfromInterval(0, events.length-1);
    eventActive = true;
    switch(events[thisEvent]) {
    case "testEvent":
      eventBox.innerHTML = "This is a test event. Normally, something cool would happen.";
      break;
    case "testEventTwo":
      eventBox.innerHTML = "Woah, this text is different than the other!"
      break;
    default:
      eventBox.innerHTML = "There was a problem displaying this event. Sorry.";
    }
    document.getElementById('eventbutton').style.display = "block";
  }
}

function endEvent() {
  eventBox.innerHTML = "";
  document.getElementById('eventbutton').style.display = "none";
  eventActive = false;
}

function toggleDebug() {
if (debug == false) {
  document.getElementById('debug').style.display = "block";
debug = true;
} else {
  document.getElementById('debug').style.display = "none";
debug = false;
}
}
  </script>
</body>
</html>